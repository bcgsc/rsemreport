{% extends "rsem_report/base.html" %}

{% load staticfiles %}

{% block title %} GSE Analysis Progress Report {% endblock %}

{% block body %}

<table class="table table-hover">
  <tr>
    <th>ID</th>
    <th>GSE</th>
    <th># of passed GSMs</th>
    <th># of running GSMs</th>
    <th># of queued GSMs</th>
    <th># of failed GSMs</th>
    <th>Passed GSMs</th>
    <th>Running GSMs</th>
    <th>Queued GSMs</th>
    <th>Failed GSMs</th>
    <th>Updated</th>
  </tr>

  {% for gse in gses %}
    
      <tr id='{{gse.name}}' class='{% if gse.passed %}success{% else %}danger{% endif %}'>
      <td>{{forloop.counter}}</td>
      <td>{{gse.name}}</td>
      <td>{{gse.num_passed_gsms}}</td>
      <td>{{gse.num_running_gsms}}</td>
      <td>{{gse.num_queued_gsms}}</td>
      <td>{{gse.num_failed_gsms}}</td>

      <td>
	{# onclick="return false;" to avoid the page from being scrolled to the top #}
	{% for gsm in gse.passed_gsms_as_list %}
	  <a href="#" onclick="return false;" class="gsm" id="{{gsm}}" data-clipboard-text="{{gse.path}}/{{gsm}}">{{gsm}}</a>
	{% endfor %}
      </td>
      <td>
	{% for gsm in gse.running_gsms_as_list %}
	  <a href="#" onclick="return false;" class="gsm" id="{{gsm}}" data-clipboard-text="{{gse.path}}/{{gsm}}">{{gsm}}</a>
	{% endfor %}
      </td>
      <td>
	{% for gsm in gse.queued_gsms_as_list %}
	  <a href="#" onclick="return false;" class="gsm" id="{{gsm}}" data-clipboard-text="{{gse.path}}/{{gsm}}">{{gsm}}</a>
	{% endfor %}
      </td>
      <td>
	{% for gsm in gse.failed_gsms_as_list %}
	  <a href="#" onclick="return false;" class="gsm" id="{{gsm}}" data-clipboard-text="{{gse.path}}/{{gsm}}">{{gsm}}</a>
	{% endfor %}
      </td>

      <td>{{gse.updated|date:"SHORT_DATETIME_FORMAT"}}</td>
    </tr>
  {% endfor %}
</table>


{# put <script> at the end to avoid blocking loading the page #}
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src='{% static 'rsem_report/ZeroClipboard/ZeroClipboard.min.js' %}'></script>
<script type="text/javascript">
var client = new ZeroClipboard($('a.gsm'));
client.on( "ready", function( readyEvent ) {
  client.on( "aftercopy", function( event ) {
    alert("Copied text to clipboard: " + event.data["text/plain"] );
  } );
} );
</script>

{% endblock %}

