{% extends "rsem_report/base.html" %}

{% load static from staticfiles %}

{% block title %} GSE Analysis Progress Report {% endblock %}

{% block body %}

<table class="table table-bordered">
  <tr>
    <th>ID</th>
    <th>GSE</th>
    <th># of passed GSMs</th>
    <th># of running GSMs</th>
    <th># of queued GSMs</th>
    <th># of failed GSMs</th>
    <th># of None GSMs</th>
    <th>Passed GSMs</th>
    <th>Running GSMs</th>
    <th>Queued GSMs</th>
    <th>Failed GSMs</th>
    <th>None GSMs*</th>
    <th>Last updated GSM</th>
  </tr>

  {% for gse in gses %}
    
      <tr id='{{gse.name}}' class='{% if gse.passed %}success{% else %}danger{% endif %}'>
      <td>{{forloop.counter}}</td>
      <td>{{gse.name}}</td>
      <td>{{gse.num_passed_gsms}}</td>
      <td>{{gse.num_running_gsms}}</td>
      <td>{{gse.num_queued_gsms}}</td>
      <td>{{gse.num_failed_gsms}}</td>
      <td>{{gse.num_none_gsms}}</td>

      <td>
	{# onclick="return false;" to avoid the page from being scrolled to the top #}
	{% for gsm in gse.passed_gsms %}
	  <a href="#" onclick="return false;" class="gsm" id="{{gsm.name}}" data-clipboard-text="{{gsm.path}}">{{gsm.name}}</a>
	{% endfor %}
      </td>
      <td>
	{% for gsm in gse.running_gsms %}
	  <a href="#" onclick="return false;" class="gsm" id="{{gsm.name}}" data-clipboard-text="{{gsm.path}}">{{gsm.name}}</a>
	{% endfor %}
      </td>
      <td>
	{% for gsm in gse.queued_gsms %}
	  <a href="#" onclick="return false;" class="gsm" id="{{gsm.name}}" data-clipboard-text="{{gsm.path}}">{{gsm.name}}</a>
	{% endfor %}
      </td>
      <td>
	{% for gsm in gse.failed_gsms %}
	  <a href="#" onclick="return false;" class="gsm" id="{{gsm.name}}" data-clipboard-text="{{gsm.path}}">{{gsm.name}}</a>
	{% endfor %}
      </td>
      <td>
	{% for gsm in gse.none_gsms %}
	  <a href="#" onclick="return false;" class="gsm" id="{{gsm.name}}" data-clipboard-text="{{gsm.path}}">{{gsm.name}}</a>
	{% endfor %}
      </td>

      <td>{{gse.last_updated_gsm.name}} at {{gse.last_updated_gsm.updated|date:"SHORT_DATETIME_FORMAT"}}</td>
    </tr>
  {% endfor %}
</table>

<div class="container"><p><strong>None GSMs*</strong>: means GSMs whose analysis have never started yet</p></div>


{# put <script> at the end to avoid blocking loading the page #}
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src='{% static 'rsem_report/ZeroClipboard/ZeroClipboard.min.js' %}'></script>
<script type="text/javascript">
var client = new ZeroClipboard($('a.gsm'));
client.on( "ready", function( readyEvent ) {
  client.on( "aftercopy", function( event ) {
    alert("Copied text to clipboard: " + event.data["text/plain"] );
  } );
} );
</script>

{% endblock %}

